var H=Object.defineProperty,K=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var M=(r,s,l)=>s in r?H(r,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[s]=l,I=(r,s)=>{for(var l in s||(s={}))U.call(s,l)&&M(r,l,s[l]);if(R)for(var l of R(s))G.call(s,l)&&M(r,l,s[l]);return r},J=(r,s)=>K(r,W(s));import{u as O,r as u,v as Q,a as E,j as e,b as o,A as X,T as Y,c as Z,d as V,F as P,e as ee,B as te,R as ae,f as T,g as se,h as ue}from"./vendor.138df582.js";const re=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&c(v)}).observe(document,{childList:!0,subtree:!0});function l(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(n){if(n.ep)return;n.ep=!0;const i=l(n);fetch(n.href,i)}};re();const ie="https://mazete-api-dev.pechakucha.ai";function le(){const r=O();return u.exports.useEffect(()=>{let s=Q();var l=JSON.stringify({register_id:s}),c={method:"post",url:`${ie}/register_id`,headers:{"Content-Type":"application/json"},data:l};E(c).then(n=>{localStorage.setItem("register_id",s)}).catch(n=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}),e("div",{className:"container",children:o("div",{className:"container-wrap",children:[e("div",{className:"top-header",children:e("h1",{children:"\u30DE\u305C\u3066"})}),o("div",{className:"top-banner",children:[e("img",{src:"/assets/image/top-banner-img01.png",alt:"",className:"top-banner01"}),e("img",{src:"/assets/image/top-banner-img02.png",alt:"",className:"top-banner02"}),e("img",{src:"/assets/image/top-banner-img03.png",alt:"",className:"top-banner03"}),e("img",{src:"/assets/image/top-banner-img04.png",alt:"",className:"top-banner04"}),e("div",{className:"top-banner-text",children:"\u203B\u30B5\u30FC\u30D3\u30B9\u5185\u5BB9\u4F1D\u308F\u308B\u30A4\u30E9\u30B9\u30C8\u5916\u6CE8"})]}),e("a",{href:"/select",className:"start-btn",children:"\u30B9\u30BF\u30FC\u30C8"}),e("div",{className:"top-banner-border"}),o("div",{className:"top-delusion",children:[e("div",{className:"top-delusion-title",children:"\u307F\u3093\u306A\u306E\u5984\u60F3"}),o("div",{className:"top-delusion-body",children:[e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img01.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img02.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img03.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img04.png",alt:"",className:"top-delusion-img"})})]})]})]})})}const $="https://mazete-api-dev.pechakucha.ai",ne=Z();function oe(){const r=O(),[s,l]=u.exports.useState(1),[c,n]=u.exports.useState([]),[i,v]=u.exports.useState(null),[A,w]=u.exports.useState(!1),[C,k]=u.exports.useState([]),[x,S]=u.exports.useState([]),[p,h]=u.exports.useState([]),[_,b]=u.exports.useState([]),[F,y]=u.exports.useState([]),[N,B]=u.exports.useState(null);u.exports.useEffect(()=>{let a=localStorage.register_id||null;a||window.location.assign("/");let t=JSON.stringify({user_id:a,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),d={method:"post",url:`${$}/get_chara_list`,headers:{"Content-Type":"application/json"},data:t};E(d).then(m=>{k(m.data.chara_list)}).catch(m=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let f=JSON.stringify({user_id:a,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),g={method:"post",url:`${$}/get_world_list`,headers:{"Content-Type":"application/json"},data:f};E(g).then(m=>{S(m.data.world_list)}).catch(m=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let D={method:"post",url:`${$}/get_autocomplete_chara`,headers:{"Content-Type":"application/json"},data:{}};E(D).then(m=>{console.log(m.data.auto_complete),b(m.data.auto_complete),y(m.data.auto_complete)}).catch(m=>{});let q={method:"post",url:`${$}/get_autocomplete_world`,headers:{"Content-Type":"application/json"},data:{}};E(q).then(m=>{h(m.data.auto_complete)}).catch(m=>{})},[]),u.exports.useEffect(()=>{i&&c.length>0&&w(!0)},[c,i]);const L=a=>{let t=c;if(t.includes(a)){for(let d=0;d<t.length;d++)t[d]===a&&(t.splice(d,1),d--);n([...t])}else t.length<3&&(t.push(a),n([...t]))},j=()=>{let a=localStorage.register_id||null,t=JSON.stringify({user_id:a,chosen_chara_ids:c.toString(),chosen_world_ids:[i].toString()}),d={method:"post",url:`${$}/generate_outline`,headers:{"Content-Type":"application/json"},data:t};E(d).then(f=>{localStorage.setItem("outline_id",f.data.outline_id),localStorage.setItem("background",x.filter(g=>g.world_id==i)[0].img_url),localStorage.setItem("user_list",JSON.stringify(c.map(g=>C.filter(D=>D.chara_id==g)[0].img_url))),window.location.assign("/synopsis")}).catch(f=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return e("div",{className:"container",id:"character_select",children:o("div",{className:"container-wrap",children:[o("div",{className:"preview",children:[o("div",{className:"preview-part",onClick:()=>{l(1),y(_),B(null)},children:[o("div",{className:"preview-img-part",children:[c.map(a=>e("img",{src:C.filter(t=>t.chara_id==a)[0].img_url,alt:""},a)),c.length==0&&e("img",{src:"/assets/image/default-avatar.png"})]}),e("div",{className:s===1?"preview-title-part active":"preview-title-part",children:"\u30AD\u30E3\u30E9"})]}),o("div",{className:"preview-part",onClick:()=>{l(2),y(p),B(null)},children:[e("div",{className:"preview-img-part",children:e("img",{src:i!=null?x.filter(a=>a.world_id==i)[0].img_url:"/assets/image/point-bg.png",alt:""})}),e("div",{className:s===2?"preview-title-part active":"preview-title-part",children:"\u4E16\u754C"})]})]}),o("div",{className:"point-select",children:[o("div",{className:"point-search",children:[e(X,{value:N,onChange:(a,t)=>{typeof t=="string"?B({kana:t}):t&&t.inputValue?B({kana:t.inputValue}):B(t)},filterOptions:(a,t)=>{const d=ne(a,t),{inputValue:f}=t,g=a.some(D=>f===D.label);return f!==""&&!g&&d.push({inputValue:f,label:`Add "${f}"`}),d},selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:F,getOptionLabel:a=>typeof a=="string"?a:a.label,renderOption:(a,t)=>e("li",J(I({},a),{children:t.label})),sx:{width:300},freeSolo:!0,renderInput:a=>e(Y,J(I({},a),{label:""}))}),e("button",{type:"button",className:"search-btn",children:e("img",{src:"/assets/image/point-search.png",alt:""})})]}),o("div",{className:"point-body",children:[s===1&&e("div",{className:"point-body-wrap",children:C.map((a,t)=>o("div",{onClick:()=>L(a.chara_id),className:`${c.includes(a.chara_id)?"active":""} character-item`,children:[e("img",{src:a.img_url,alt:""}),e("span",{})]},t))}),s==2&&e("div",{className:"point-body-wrap",children:x.map((a,t)=>o("div",{className:`${i==a.world_id?"active":""} location-item`,onClick:d=>{v(a.world_id)},children:[e("img",{src:a.img_url,alt:""}),e("span",{})]},t))}),e("button",{onClick:j,className:`character-add-btn ${A?"active":""}`,disabled:!A,children:"\u30DE\u305C\u308B"})]})]})]})})}const z="https://mazete-api-dev.pechakucha.ai";function ce(){const r=O(),s=u.exports.useRef(),[l,c]=u.exports.useState(!1),[n,i]=u.exports.useState(!0),[v,A]=u.exports.useState(`\u30D3\u30EB\u306E\u5C4B\u4E0A\u306B\u3042\u3064\u3081\u3089\u308C\u305F\u30B4\u30F3\u9054\u3002

\u5229\u6839\u5DDD\u304B\u3089\u9244\u9AA8\u306E\u4E0A\u3092\u6E21\u3063\u3066\u3001\u5411\u3053\u3046\u306E\u30D3\u30EB\u3078\u884C\u3051\u305F\u3082\u306E\u306B\u8CDE\u91D1\u304C\u3082\u3089\u3048\u308B\u3068\u8AAC\u660E\u3092\u53D7\u3051\u308B\u3002

\u30B4\u30F3\u9054\u306F\u3044\u304B\u306B\u3057\u3066\u3053\u306E\u5371\u6A5F\u3092\u4E57\u308A\u8D8A\u3048\u308B\u306E\u304B\uFF1F`),[w,C]=u.exports.useState([]),[k,x]=u.exports.useState(null);u.exports.useEffect(()=>{let p=localStorage.register_id||null,h=localStorage.outline_id||null,_=localStorage.background||null,b=localStorage.user_list||null;console.log(b,_),(!b||!_)&&r("/select",{state:{}}),x(_),C(JSON.parse(b));let F=JSON.stringify({user_id:p,outline_id:h}),y={method:"post",url:`${z}/get_outline`,headers:{"Content-Type":"application/json"},data:F};E(y).then(N=>{N.data.generated&&N.data.outline&&!N.data.error?(i(!1),A(N.data.outline)):r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(N=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]);const S=()=>{let p=localStorage.register_id||null,h=localStorage.outline_id||null,_=JSON.stringify({user_id:p,outline_id:h,outline:v}),b={method:"post",url:`${z}/generate_story`,headers:{"Content-Type":"application/json"},data:_};E(b).then(F=>{window.location.assign(`/talk/${F.data.story_id}`)}).catch(F=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return u.exports.useEffect(()=>{s.current&&l&&s.current.focus()},[l]),e("div",{className:"container",id:"loading_synposis",children:o("div",{className:"container-wrap",children:[e("div",{className:`ls-top ${l?"editing":""}`,children:e("div",{className:"ls-top-wrap",style:{backgroundImage:`url(${k}`},children:e("div",{className:"ls-top-body",children:w.map((p,h)=>e("div",{className:"ls-top-item",children:e("img",{src:p,alt:""})},h))})})}),o("div",{className:"ls-main",children:[e("div",{className:"ls-main-title",children:"\u3042\u3089\u3059\u3058"}),o("div",{className:"ls-main-loading-text",children:[n&&o("div",{className:"ls-main-loading-part",children:[e("img",{src:"/assets/image/white-loading.gif",alt:""}),e("span",{children:"\u4E0B\u66F8\u304D\u6E96\u5099\u4E2D"})]}),!n&&e("textarea",{ref:s,className:"ls-main-loading-wrap",value:v,disabled:!l,onChange:p=>{A(p.target.value)},onBlur:()=>{c(!1)}})]}),!l&&e("div",{className:"ls-main-edit-btn",children:o("a",{onClick:()=>{s.current.focus(),c(!0)},children:[e("span",{children:"\u7DE8\u96C6"}),e("img",{src:"/assets/image/edit-icon.png",alt:""})]})}),!l&&e("button",{onClick:S,className:n?"ls-main-making-btn":"ls-main-making-btn active",disabled:n,children:"\u3053\u306E\u4E16\u754C\u7DDA\u306B\u5165\u308B"})]})]})})}const de="https://mazete-api-dev.pechakucha.ai";function pe(r){return new Promise(s=>setTimeout(s,r))}function me(){const r=O(),[s,l]=u.exports.useState(!0),[c,n]=u.exports.useState(null),[i,v]=u.exports.useState(0),[A,w]=u.exports.useState(null),[C,k]=u.exports.useState(null),[x,S]=u.exports.useState([]),[p,h]=u.exports.useState(!1),[_,b]=u.exports.useState(!1),[F,y]=u.exports.useState(!1);let{story_id:N}=V();u.exports.useEffect(()=>{let t=localStorage.register_id||null,d=JSON.stringify({user_id:t,story_id:N}),f={method:"post",url:`${de}/get_story`,headers:{"Content-Type":"application/json"},data:d};E(f).then(g=>{l(!1),g.data.generated&&!g.data.error?(l(!1),n(g.data)):r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(g=>{r("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]),u.exports.useEffect(()=>{c&&B()},[c,i]);const B=()=>{let t=c.story;k(t[i].chara_img_url),w(t[i].position),t[i].multiple?(h(!0),S(t[i].content)):(h(!1),L(t[i].content))},L=async t=>{y(!0);for(var d=0;d<t.length;)S([t.substring(0,d+1)]),d++,await pe(75);y(!1),c.story.length-1==i&&b(!0)},j=t=>{p&&(h(!1),L(t))},a=()=>{console.log(c.story),F||c.story.length-1>i&&v(i+1)};return o(P,{children:[s&&o("div",{className:"container",id:"loading_adventure",children:[e("div",{className:"container-wrap",children:o("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})}),e("button",{className:"back-to-btn",onClick:()=>{r("/synopsis",{state:{}})},children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]}),!s&&o("div",{className:"container",id:"adventure_state",children:[o("div",{className:"container-wrap",children:[e("div",{className:"as-thumb",style:{backgroundImage:`url(${c==null?void 0:c.background_url})`},children:C&&e("img",{src:C,alt:"",className:`as-thumb-character ${A==0?"lb":A==1?"mb":"rb"}`})}),e("div",{className:"as-text",children:x.map((t,d)=>e("div",{className:"as-text-wrap",onClick:()=>{j(t)},children:t},d))}),!_&&o("div",{className:"text-select-btn-group",children:[!p&&e("a",{onClick:a,className:"next-btn",children:"\u30BF\u30C3\u30D7\u3057\u3066\u6B21\u3078\xA0\xA0\u25B6"}),p&&e("a",{className:"next-btn active",children:"\u9078\u629E\u3057\u3066\u4E0B\u3055\u3044\xA0\xA0\u25B6"})]}),_&&o("div",{className:"text-select-btn-group",children:[e("a",{href:"",className:"final-btn",children:"\u3082\u3046\u4E00\u5EA6\u898B\u308B"}),e("a",{href:"",className:"final-btn",children:"\u3053\u306E\u7269\u8A9E\u3092\u30B7\u30A7\u30A2\u3059\u308B"})]})]}),e("button",{className:"back-to-btn",onClick:()=>{r("/synopsis",{state:{}})},children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]})]})}function ge(){const r=ee();return console.log(r),e("div",{className:"flex-center position-ref full-height full-width bg-white",children:e("div",{className:"message",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:r.state.message}})})}function he(){return e(te,{children:o(ae,{children:[e(T,{path:"/",element:e(le,{})}),e(T,{path:"/select",element:e(oe,{})}),e(T,{path:"/synopsis",element:e(ce,{})}),e(T,{path:"/talk/:id",element:e(me,{})}),e(T,{path:"/error",element:e(ge,{})})]})})}function fe(){return e(P,{children:e(he,{})})}se.render(e(ue.StrictMode,{children:e(fe,{})}),document.getElementById("root"));
