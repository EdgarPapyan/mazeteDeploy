var K=Object.defineProperty,W=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var P=(a,u,l)=>u in a?K(a,u,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[u]=l,R=(a,u)=>{for(var l in u||(u={}))U.call(u,l)&&P(a,l,u[l]);if(M)for(var l of M(u))Q.call(u,l)&&P(a,l,u[l]);return a},q=(a,u)=>W(a,G(u));import{u as j,r as i,v as X,a as _,j as e,b as o,A as Y,T as Z,c as V,d as ee,F as z,e as te,B as ae,R as ue,f as $,g as se,h as re}from"./vendor.138df582.js";const ie=function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function l(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(n){if(n.ep)return;n.ep=!0;const s=l(n);fetch(n.href,s)}};ie();const le="https://mazete-api-dev.pechakucha.ai";function ne(){const a=j();return i.exports.useEffect(()=>{let u=X();var l=JSON.stringify({register_id:u}),c={method:"post",url:`${le}/register_id`,headers:{"Content-Type":"application/json"},data:l};_(c).then(n=>{localStorage.setItem("register_id",u)}).catch(n=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}),e("div",{className:"container",children:o("div",{className:"container-wrap",children:[e("div",{className:"top-header",children:e("h1",{children:"\u30DE\u305C\u3066"})}),o("div",{className:"top-banner",children:[e("img",{src:"/assets/image/top-banner-img01.png",alt:"",className:"top-banner01"}),e("img",{src:"/assets/image/top-banner-img02.png",alt:"",className:"top-banner02"}),e("img",{src:"/assets/image/top-banner-img03.png",alt:"",className:"top-banner03"}),e("img",{src:"/assets/image/top-banner-img04.png",alt:"",className:"top-banner04"}),e("div",{className:"top-banner-text",children:"\u203B\u30B5\u30FC\u30D3\u30B9\u5185\u5BB9\u4F1D\u308F\u308B\u30A4\u30E9\u30B9\u30C8\u5916\u6CE8"})]}),e("a",{href:"/select",className:"start-btn",children:"\u30B9\u30BF\u30FC\u30C8"}),e("div",{className:"top-banner-border"}),o("div",{className:"top-delusion",children:[e("div",{className:"top-delusion-title",children:"\u307F\u3093\u306A\u306E\u5984\u60F3"}),o("div",{className:"top-delusion-body",children:[e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img01.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img02.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img03.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img04.png",alt:"",className:"top-delusion-img"})})]})]})]})})}const S="https://mazete-api-dev.pechakucha.ai",oe=V({stringify:a=>a.kana+a.label});function ce(){const a=j(),[u,l]=i.exports.useState(1),[c,n]=i.exports.useState([]),[s,h]=i.exports.useState(null),[F,D]=i.exports.useState(!1),[C,w]=i.exports.useState([]),[k,B]=i.exports.useState([]),[g,f]=i.exports.useState([]),[v,b]=i.exports.useState([]),[E,y]=i.exports.useState([]),[N,x]=i.exports.useState(null);i.exports.useEffect(()=>{let r=localStorage.register_id||null;r||window.location.assign("/");let t=JSON.stringify({user_id:r,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),d={method:"post",url:`${S}/get_chara_list`,headers:{"Content-Type":"application/json"},data:t};_(d).then(p=>{w(p.data.chara_list)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let m=JSON.stringify({user_id:r,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),A={method:"post",url:`${S}/get_world_list`,headers:{"Content-Type":"application/json"},data:m};_(A).then(p=>{B(p.data.world_list)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let L={method:"post",url:`${S}/get_autocomplete_chara`,headers:{"Content-Type":"application/json"},data:{}};_(L).then(p=>{b(p.data.auto_complete),y(p.data.auto_complete)}).catch(p=>{});let T={method:"post",url:`${S}/get_autocomplete_world`,headers:{"Content-Type":"application/json"},data:{}};_(T).then(p=>{f(p.data.auto_complete)}).catch(p=>{})},[]),i.exports.useEffect(()=>{s&&c.length>0&&D(!0)},[c,s]);const O=r=>{let t=c,d=C.filter(m=>m.chara_id==r)[0];if(t.includes(d)){for(let m=0;m<t.length;m++)t[m].chara_id===r&&(t.splice(m,1),m--);n([...t])}else t.length<3&&(t.push(d),n([...t]))},I=()=>{let r=localStorage.register_id||null,t=JSON.stringify({user_id:r,chosen_chara_ids:c.toString(),chosen_world_ids:[s].toString()}),d={method:"post",url:`${S}/generate_outline`,headers:{"Content-Type":"application/json"},data:t};_(d).then(m=>{localStorage.setItem("outline_id",m.data.outline_id),localStorage.setItem("background",s.img_url),localStorage.setItem("user_list",JSON.stringify(c.map(A=>A.img_url))),window.location.assign("/synopsis")}).catch(m=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},J=r=>{r.preventDefault();let t=localStorage.register_id||null,d=N,m=C.toString(),A=k.toString(),L=JSON.stringify({user_id:t,search_query:d,chosen_chara_ids:m,chosen_world_ids:A});if(u==1){let T={method:"post",url:`${S}/get_chara_list`,headers:{"Content-Type":"application/json"},data:L};_(T).then(p=>{w(p.data.chara_list)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}else{let T={method:"post",url:`${S}/get_world_list`,headers:{"Content-Type":"application/json"},data:L};_(T).then(p=>{B(p.data.world_list)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}};return e("div",{className:"container",id:"character_select",children:o("div",{className:"container-wrap",children:[o("div",{className:"preview",children:[o("div",{className:"preview-part",onClick:()=>{l(1),y(v),x(null)},children:[o("div",{className:"preview-img-part",children:[c.map(r=>e("img",{src:r.img_url,alt:""},r.chara_id)),c.length==0&&e("img",{src:"/assets/image/default-avatar.png"})]}),e("div",{className:u===1?"preview-title-part active":"preview-title-part",children:"\u30AD\u30E3\u30E9"})]}),o("div",{className:"preview-part",onClick:()=>{l(2),y(g),x(null)},children:[e("div",{className:"preview-img-part",children:e("img",{src:s!=null?s.img_url:"/assets/image/point-bg.png",alt:""})}),e("div",{className:u===2?"preview-title-part active":"preview-title-part",children:"\u4E16\u754C"})]})]}),o("div",{className:"point-select",children:[e("div",{className:"point-search",children:o("form",{onSubmit:J,children:[e(Y,{value:N,onChange:(r,t)=>{typeof t=="string"?x({label:t}):t&&t.inputValue?x({label:t.inputValue}):x(t)},filterOptions:(r,t)=>oe(r,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:E,getOptionLabel:r=>typeof r=="string"?r:r.label,renderOption:(r,t)=>e("li",q(R({},r),{children:t.label})),renderInput:r=>e(Z,q(R({},r),{label:""}))}),e("button",{className:"search-btn",children:e("img",{src:"/assets/image/point-search.png",alt:""})})]})}),o("div",{className:"point-body",children:[u===1&&e("div",{className:"point-body-wrap",children:C.map((r,t)=>o("div",{onClick:()=>O(r.chara_id),className:`${c.includes(r)?"active":""} character-item`,children:[e("img",{src:r.img_url,alt:""}),e("span",{})]},t))}),u==2&&e("div",{className:"point-body-wrap",children:k.map((r,t)=>o("div",{className:`${s==r?"active":""} location-item`,onClick:d=>{h(r)},children:[e("img",{src:r.img_url,alt:""}),e("span",{})]},t))}),e("button",{onClick:I,className:`character-add-btn ${F?"active":""}`,disabled:!F,children:"\u30DE\u305C\u308B"})]})]})]})})}const H="https://mazete-api-dev.pechakucha.ai";function de(){const a=j(),u=i.exports.useRef(),[l,c]=i.exports.useState(!1),[n,s]=i.exports.useState(!0),[h,F]=i.exports.useState(`\u30D3\u30EB\u306E\u5C4B\u4E0A\u306B\u3042\u3064\u3081\u3089\u308C\u305F\u30B4\u30F3\u9054\u3002

\u5229\u6839\u5DDD\u304B\u3089\u9244\u9AA8\u306E\u4E0A\u3092\u6E21\u3063\u3066\u3001\u5411\u3053\u3046\u306E\u30D3\u30EB\u3078\u884C\u3051\u305F\u3082\u306E\u306B\u8CDE\u91D1\u304C\u3082\u3089\u3048\u308B\u3068\u8AAC\u660E\u3092\u53D7\u3051\u308B\u3002

\u30B4\u30F3\u9054\u306F\u3044\u304B\u306B\u3057\u3066\u3053\u306E\u5371\u6A5F\u3092\u4E57\u308A\u8D8A\u3048\u308B\u306E\u304B\uFF1F`),[D,C]=i.exports.useState([]),[w,k]=i.exports.useState(null);i.exports.useEffect(()=>{let g=localStorage.register_id||null,f=localStorage.outline_id||null,v=localStorage.background||null,b=localStorage.user_list||null;console.log(b,v),(!b||!v)&&a("/select",{state:{}}),k(v),C(JSON.parse(b));let E=JSON.stringify({user_id:g,outline_id:f}),y={method:"post",url:`${H}/get_outline`,headers:{"Content-Type":"application/json"},data:E};_(y).then(N=>{N.data.generated&&N.data.outline&&!N.data.error?(s(!1),F(N.data.outline)):a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(N=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]);const B=()=>{let g=localStorage.register_id||null,f=localStorage.outline_id||null,v=JSON.stringify({user_id:g,outline_id:f,outline:h}),b={method:"post",url:`${H}/generate_story`,headers:{"Content-Type":"application/json"},data:v};_(b).then(E=>{window.location.assign(`/talk/${E.data.story_id}`)}).catch(E=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return i.exports.useEffect(()=>{u.current&&l&&u.current.focus()},[l]),e("div",{className:"container",id:"loading_synposis",children:o("div",{className:"container-wrap",children:[e("div",{className:`ls-top ${l?"editing":""}`,children:e("div",{className:"ls-top-wrap",style:{backgroundImage:`url(${w}`},children:e("div",{className:"ls-top-body",children:D.map((g,f)=>e("div",{className:"ls-top-item",children:e("img",{src:g,alt:""})},f))})})}),o("div",{className:"ls-main",children:[e("div",{className:"ls-main-title",children:"\u3042\u3089\u3059\u3058"}),o("div",{className:"ls-main-loading-text",children:[n&&o("div",{className:"ls-main-loading-part",children:[e("img",{src:"/assets/image/white-loading.gif",alt:""}),e("span",{children:"\u4E0B\u66F8\u304D\u6E96\u5099\u4E2D"})]}),!n&&e("textarea",{ref:u,className:"ls-main-loading-wrap",value:h,disabled:!l,onChange:g=>{F(g.target.value)},onBlur:()=>{c(!1)}})]}),!l&&o("a",{className:"ls-main-edit-btn",onClick:()=>{u.current.focus(),c(!0)},children:[e("span",{children:"\u7DE8\u96C6"}),e("img",{src:"/assets/image/edit-icon.png",alt:""})]}),!l&&e("button",{onClick:B,className:n?"ls-main-making-btn":"ls-main-making-btn active",disabled:n,children:"\u3053\u306E\u4E16\u754C\u7DDA\u306B\u5165\u308B"})]})]})})}const pe="https://mazete-api-dev.pechakucha.ai";function me(a){return new Promise(u=>setTimeout(u,a))}function ge(){const a=j(),[u,l]=i.exports.useState(!0),[c,n]=i.exports.useState(null),[s,h]=i.exports.useState(0),[F,D]=i.exports.useState(null),[C,w]=i.exports.useState(null),[k,B]=i.exports.useState([]),[g,f]=i.exports.useState(!1),[v,b]=i.exports.useState(!1),[E,y]=i.exports.useState(!1);let{story_id:N}=ee();i.exports.useEffect(()=>{let t=localStorage.register_id||null,d=JSON.stringify({user_id:t,story_id:N}),m={method:"post",url:`${pe}/get_story`,headers:{"Content-Type":"application/json"},data:d};_(m).then(A=>{l(!1),A.data.generated&&!A.data.error?(l(!1),n(A.data)):a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(A=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]),i.exports.useEffect(()=>{c&&x()},[c,s]);const x=()=>{let t=c.story;w(t[s].chara_img_url),D(t[s].position),t[s].multiple?(f(!0),B(t[s].content)):(f(!1),O(t[s].content))},O=async t=>{y(!0);for(var d=0;d<t.length;)B([t.substring(0,d+1)]),d++,await me(75);y(!1),c.story.length-1==s&&b(!0)},I=t=>{g&&(f(!1),O(t))},J=()=>{!E&&!g&&c.story.length-1>s&&h(s+1)},r=()=>{console.log(s),s===0&&a("/synopsis",{state:{}}),s!=0&&!E&&(h(s-1),b(!1))};return o(z,{children:[u&&o("div",{className:"container",id:"loading_adventure",children:[e("div",{className:"container-wrap",children:o("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})}),e("button",{className:"back-to-btn",onClick:r,children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]}),!u&&o("div",{className:"container",id:"adventure_state",children:[o("div",{className:"container-wrap",onClick:J,children:[e("div",{className:"as-thumb",style:{backgroundImage:`url(${c==null?void 0:c.background_url})`},children:C&&e("img",{src:C,alt:"",className:`as-thumb-character ${F==0?"lb":F==1?"mb":"rb"}`})}),e("div",{className:"as-text",children:k.map((t,d)=>e("div",{className:"as-text-wrap",onClick:()=>{I(t)},children:t},d))}),!v&&o("div",{className:"text-select-btn-group",children:[!g&&e("a",{className:"next-btn",children:"\u30BF\u30C3\u30D7\u3057\u3066\u6B21\u3078\xA0\xA0\u25B6"}),g&&e("a",{className:"next-btn active",children:"\u9078\u629E\u3057\u3066\u4E0B\u3055\u3044\xA0\xA0\u25B6"})]}),v&&o("div",{className:"text-select-btn-group",children:[e("a",{href:"",className:"final-btn",children:"\u3082\u3046\u4E00\u5EA6\u898B\u308B"}),e("a",{href:"",className:"final-btn",children:"\u3053\u306E\u7269\u8A9E\u3092\u30B7\u30A7\u30A2\u3059\u308B"})]})]}),e("button",{className:"back-to-btn",onClick:r,children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]})]})}function he(){const a=te();return console.log(a),e("div",{className:"flex-center position-ref full-height full-width bg-white",children:e("div",{className:"message",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:a.state.message}})})}function fe(){return e(ae,{children:o(ue,{children:[e($,{path:"/",element:e(ne,{})}),e($,{path:"/select",element:e(ce,{})}),e($,{path:"/synopsis",element:e(de,{})}),e($,{path:"/talk/:id",element:e(ge,{})}),e($,{path:"/error",element:e(he,{})})]})})}function _e(){return e(z,{children:e(fe,{})})}se.render(e(re.StrictMode,{children:e(_e,{})}),document.getElementById("root"));
