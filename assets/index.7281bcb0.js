var V=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var K=(a,s,r)=>s in a?V(a,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[s]=r,H=(a,s)=>{for(var r in s||(s={}))ae.call(s,r)&&K(a,r,s[r]);if(M)for(var r of M(s))ue.call(s,r)&&K(a,r,s[r]);return a},P=(a,s)=>ee(a,te(s));import{u as q,a as U,r as i,v as se,b as w,j as h,c as e,A as re,T as ie,d as ne,e as le,F as G,B as oe,R as ce,f as j,g as de,h as he}from"./vendor.744e6562.js";const pe=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const g of u.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function r(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function l(o){if(o.ep)return;o.ep=!0;const u=r(o);fetch(o.href,u)}};pe();const S="https://mazete-api-dev.pechakucha.ai",ge=ne({stringify:a=>a.kana+a.label});function me(){const[a,s]=i.exports.useState([0,0]);return i.exports.useLayoutEffect(()=>{function r(){s([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),a}function fe(){const a=q();U();const[s,r]=i.exports.useState(1),[l,o]=i.exports.useState([]),[u,g]=i.exports.useState(null),[C,D]=i.exports.useState(!1),[A,$]=i.exports.useState([]),[T,L]=i.exports.useState([]),[N,x]=i.exports.useState([]),[m,f]=i.exports.useState([]),[F,v]=i.exports.useState([]),[b,E]=i.exports.useState(null),[z,y]=me();i.exports.useEffect(()=>{let n=window.innerHeight;document.getElementById("character_select").style.height=n+"px";let t=se();var d=JSON.stringify({register_id:t}),c={method:"post",url:`${S}/register_id`,headers:{"Content-Type":"application/json"},data:d};w(c).then(p=>{localStorage.setItem("register_id",t)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let _=JSON.stringify({user_id:t,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),I={method:"post",url:`${S}/get_chara_list`,headers:{"Content-Type":"application/json"},data:_};w(I).then(p=>{$(p.data.chara_list)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let B=JSON.stringify({user_id:t,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),k={method:"post",url:`${S}/get_world_list`,headers:{"Content-Type":"application/json"},data:B};w(k).then(p=>{L(p.data.world_list)}).catch(p=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let Y={method:"post",url:`${S}/get_autocomplete_chara`,headers:{"Content-Type":"application/json"},data:{}};w(Y).then(p=>{f(p.data.auto_complete),v(p.data.auto_complete)}).catch(p=>{});let Z={method:"post",url:`${S}/get_autocomplete_world`,headers:{"Content-Type":"application/json"},data:{}};w(Z).then(p=>{x(p.data.auto_complete)}).catch(p=>{})},[]),i.exports.useEffect(()=>{u&&l.length>0&&D(!0)},[l,u]);const J=n=>{let t=l,d=A.filter(c=>c.chara_id==n)[0];if(t.map(c=>c.chara_id).includes(n)){for(let c=0;c<t.length;c++)t[c].chara_id===n&&(t.splice(c,1),c--);o([...t])}else t.length<3&&(t.push(d),o([...t]))},O=()=>{let n=localStorage.register_id||null,t=JSON.stringify({user_id:n,chosen_chara_ids:l.map(c=>c.chara_id).toString(),chosen_world_ids:[u.world_id].toString()}),d={method:"post",url:`${S}/generate_outline`,headers:{"Content-Type":"application/json"},data:t};w(d).then(c=>{localStorage.setItem("outline_id",c.data.outline_id),localStorage.setItem("background",u.img_url),localStorage.setItem("user_list",JSON.stringify(l.map(_=>_.img_url))),window.location.assign("/synopsis")}).catch(c=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},R=n=>{n.preventDefault();let t=localStorage.register_id||null,d=b,c=l.map(B=>B.chara_id).toString(),_="";u&&(_=[u.world_id].toString());let I=JSON.stringify({user_id:t,search_query:d,chosen_chara_ids:c,chosen_world_ids:_});if(s==1){let B={method:"post",url:`${S}/get_chara_list`,headers:{"Content-Type":"application/json"},data:I};w(B).then(k=>{$(k.data.chara_list)}).catch(k=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}else{let B={method:"post",url:`${S}/get_world_list`,headers:{"Content-Type":"application/json"},data:I};w(B).then(k=>{L(k.data.world_list)}).catch(k=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}},W=n=>t=>{t.stopPropagation();let d=l;for(let c=0;c<d.length;c++)d[c].chara_id===n&&(d.splice(c,1),c--);o([...d])};return h("div",{className:"container",id:"character_select",children:[h("div",{className:"container-wrap",children:[h("div",{className:"common-header",children:[e("div",{className:"common-header-title01",children:"-\u4F5C\u54C1\u30EA\u30DF\u30C3\u30AF\u30B9-"}),e("div",{className:"common-header-title02",children:"\u30DE\u305C\u3066"})]}),h("div",{className:"preview",children:[h("div",{className:"preview-part",onClick:()=>{r(1),v(m),E(null)},children:[h("div",{className:"preview-img-part",children:[l.map(n=>e("div",{style:{backgroundImage:`url(${n.img_url})`},className:"avatar-preview",children:h("div",{className:"avatar-preview-close",onClick:W(n.chara_id),children:[e("span",{}),e("span",{})]})},n.chara_id)),l.length==0&&e("div",{className:"avatar-preview",style:{backgroundImage:"url(/assets/image/default-avatar.png)"}})]}),e("div",{className:s===1?"preview-title-part active":"preview-title-part",children:"\u30AD\u30E3\u30E9"})]}),h("div",{className:"preview-part",onClick:()=>{r(2),v(N),E(null)},children:[e("div",{className:"preview-img-part",children:e("div",{style:{backgroundImage:`url(${u!=null?u.img_url:"/assets/image/point-bg.png"})`},className:u!=null?"world-preview":"world-none-preview"})}),e("div",{className:s===2?"preview-title-part active":"preview-title-part",children:"\u4E16\u754C"})]})]}),h("div",{className:"point-select",children:[e("div",{className:"point-search",children:h("form",{onSubmit:R,children:[e(re,{value:b,onChange:(n,t)=>{typeof t=="string"?E({label:t}):t&&t.inputValue?E({label:t.inputValue}):E(t)},filterOptions:(n,t)=>ge(n,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:F,getOptionLabel:n=>typeof n=="string"?n:n.label,renderOption:(n,t)=>e("li",P(H({},n),{children:t.label})),renderInput:n=>e(ie,P(H({},n),{label:""}))}),e("button",{className:"search-btn",children:e("img",{src:"/assets/image/point-search.png",alt:""})})]})}),e("div",{className:"point-intro",children:"\u753B\u50CF\u306FBing\u306E\u691C\u7D22\u7D50\u679C\u3092\u3082\u3068\u306B\u8868\u793A\u3057\u3066\u3044\u307E\u3059"}),h("div",{className:"point-body",style:{height:`calc(${y}px - 420px)`},children:[s===1&&e("div",{className:"point-body-wrap",children:A.map((n,t)=>e("div",{style:{backgroundImage:`url(${n.img_url})`},onClick:()=>J(n.chara_id),className:`${l.map(d=>d.chara_id).includes(n.chara_id)?"active":""} character-item`,children:e("span",{})},t))}),s==2&&e("div",{className:"point-body-wrap",children:T.map((n,t)=>e("div",{style:{backgroundImage:`url(${n.img_url})`},className:`${(u==null?void 0:u.img_url)==n.img_url?"active":""} location-item`,onClick:d=>{g(n)},children:e("span",{})},t))})]})]})]}),e("div",{className:"character-add-btn-part",children:e("button",{onClick:O,className:`character-add-btn ${C?"active":""}`,disabled:!C,children:"\u30DE\u305C\u308B"})})]})}const Q="https://mazete-api-dev.pechakucha.ai";function ve(){const[a,s]=i.exports.useState([0,0]);return i.exports.useLayoutEffect(()=>{function r(){s([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),a}function _e(){const a=q(),s=i.exports.useRef(),[r,l]=i.exports.useState(!1),[o,u]=i.exports.useState(!0),[g,C]=i.exports.useState(`\u30D3\u30EB\u306E\u5C4B\u4E0A\u306B\u3042\u3064\u3081\u3089\u308C\u305F\u30B4\u30F3\u9054\u3002

\u5229\u6839\u5DDD\u304B\u3089\u9244\u9AA8\u306E\u4E0A\u3092\u6E21\u3063\u3066\u3001\u5411\u3053\u3046\u306E\u30D3\u30EB\u3078\u884C\u3051\u305F\u3082\u306E\u306B\u8CDE\u91D1\u304C\u3082\u3089\u3048\u308B\u3068\u8AAC\u660E\u3092\u53D7\u3051\u308B\u3002

\u30B4\u30F3\u9054\u306F\u3044\u304B\u306B\u3057\u3066\u3053\u306E\u5371\u6A5F\u3092\u4E57\u308A\u8D8A\u3048\u308B\u306E\u304B\uFF1F`),[D,A]=i.exports.useState([]),[$,T]=i.exports.useState(null),[L,N]=ve();i.exports.useEffect(()=>{let m=window.innerHeight;document.getElementById("loading_synposis").style.height=m+"px";let f=localStorage.register_id||null,F=localStorage.outline_id||null,v=localStorage.background||null,b=localStorage.user_list||null;(!b||!v)&&a("/",{state:{}}),T(v),A(JSON.parse(b));let E=JSON.stringify({user_id:f,outline_id:F}),z={method:"post",url:`${Q}/get_outline`,headers:{"Content-Type":"application/json"},data:E};w(z).then(y=>{y.data.generated&&y.data.outline&&!y.data.error?(u(!1),C(y.data.outline)):a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(y=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]);const x=()=>{let m=localStorage.register_id||null,f=localStorage.outline_id||null,F=JSON.stringify({user_id:m,outline_id:f,outline:g}),v={method:"post",url:`${Q}/generate_story`,headers:{"Content-Type":"application/json"},data:F};w(v).then(b=>{window.location.assign(`/talk/${b.data.story_id}`)}).catch(b=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return i.exports.useEffect(()=>{s.current&&r&&s.current.focus()},[r]),h("div",{className:"container",id:"loading_synposis",children:[h("div",{className:"container-wrap",children:[e("div",{className:`ls-top ${r?"editing":""}`,children:e("div",{className:"",style:{backgroundImage:`url(${$}`,backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},children:e("div",{className:"ls-top-body",children:D.map((m,f)=>e("div",{className:"ls-top-item",style:{backgroundImage:`url(${m})`}},f))})})}),h("div",{className:"ls-main",style:{height:`calc(${N}px - 280px)`},children:[e("div",{className:"ls-main-title",children:"\u3042\u3089\u3059\u3058"}),h("div",{className:"ls-main-loading-text",style:{height:"calc(100% - 70px)"},children:[o&&h("div",{className:"ls-main-loading-part",children:[e("img",{src:"/assets/image/white-loading.gif",alt:""}),e("span",{children:"\u4E0B\u66F8\u304D\u6E96\u5099\u4E2D"})]}),!o&&e("textarea",{ref:s,className:"ls-main-loading-wrap",value:g,disabled:!r,onChange:m=>{C(m.target.value)},onBlur:()=>{l(!1)}})]}),!r&&h("a",{className:"ls-main-edit-btn",onClick:()=>{s.current.focus(),l(!0)},children:[e("span",{children:"\u7DE8\u96C6"}),e("img",{src:"/assets/image/edit-icon.png",alt:""})]})]})]}),!r&&e("button",{className:"back-to-btn",onClick:()=>{let m=localStorage.user_list||null;a("/",{state:{user_list:m}})},children:e("img",{src:"/assets/image/back-to-img.png",alt:""})}),!r&&e("div",{className:"ls-main-making-btn-part",children:e("button",{onClick:x,className:o?"ls-main-making-btn":"ls-main-making-btn active",disabled:o,children:"\u3053\u306E\u4E16\u754C\u7DDA\u306B\u5165\u308B"})})]})}const we="https://mazete-api-dev.pechakucha.ai";function X(a){return new Promise(s=>setTimeout(s,a))}function be(){const[a,s]=i.exports.useState([0,0]);return i.exports.useLayoutEffect(()=>{function r(){s([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),a}function Ee(){const a=q(),[s,r]=i.exports.useState(!0),[l,o]=i.exports.useState(null),[u,g]=i.exports.useState(0),[C,D]=i.exports.useState(null),[A,$]=i.exports.useState(null),[T,L]=i.exports.useState([]),[N,x]=i.exports.useState(!1),[m,f]=i.exports.useState(!1),[F,v]=i.exports.useState(!1),[b,E]=be();let{story_id:z}=le();i.exports.useEffect(()=>{let t=localStorage.register_id||null,d=JSON.stringify({user_id:t,story_id:z}),c={method:"post",url:`${we}/get_story`,headers:{"Content-Type":"application/json"},data:d};w(c).then(_=>{r(!1),_.data.generated&&!_.data.error?(r(!1),o(_.data)):a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(_=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}),window.history.pushState(null,null,window.location.pathname),window.addEventListener("popstate",y)},[]);const y=t=>{t.preventDefault(),g(0),f(!1),window.history.pushState(null,null,window.location.pathname)};i.exports.useEffect(()=>{l&&J()},[l,u]),i.exports.useEffect(async()=>{if(l){let t=l.story;await X(1),D(t[u].position)}},[A]);const J=()=>{let t=l.story;$(t[u].chara_img_url),t[u].multiple?(x(!0),L(t[u].content)):(x(!1),O(t[u].content))},O=async t=>{v(!0);for(var d=0;d<t.length;)L([t.substring(0,d+1)]),d++,await X(75);v(!1),l.story.length-1==u&&f(!0)},R=t=>{N&&(x(!1),O(t))},W=()=>{!F&&!N&&l.story.length-1>u&&g(u+1)},n=()=>{console.log(u),u===0&&a("/synopsis",{state:{}}),u!=0&&!F&&(g(u-1),f(!1))};return h(G,{children:[s&&h("div",{className:"container",id:"loading_adventure",children:[e("div",{className:"container-wrap",children:h("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})}),e("button",{className:"back-to-btn",onClick:n,children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]}),!s&&h("div",{className:"container",id:"adventure_state",style:{height:E},children:[h("div",{className:"container-wrap",onClick:W,children:[e("div",{className:"as-thumb",style:{backgroundImage:`url(${l==null?void 0:l.background_url})`},children:A&&e("img",{src:A,alt:"",className:`as-thumb-character ${C==0?"lb":C==1?"mb":"rb"}`})}),e("div",{className:"as-text",children:T.map((t,d)=>e("div",{className:`as-text-wrap ${N?"":"arrow"}`,onClick:()=>{R(t)},children:t},d))})]}),e("button",{className:"back-to-btn",onClick:n,children:e("img",{src:"/assets/image/back-to-img.png",alt:""})}),m&&h("div",{className:"text-select-btn-group",children:[e("a",{onClick:()=>{g(0),f(!1)},className:"final-btn",children:"\u30C8\u30C3\u30D7\u3078"}),e("a",{className:"final-btn",children:"\u30B7\u30A7\u30A2"})]})]})]})}function ye(){const a=U();return console.log(a),e("div",{className:"flex-center position-ref full-height full-width bg-white",children:e("div",{className:"message",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:a.state.message}})})}function Ce(){return e(oe,{children:h(ce,{children:[e(j,{path:"/",element:e(fe,{})}),e(j,{path:"/synopsis",element:e(_e,{})}),e(j,{path:"/talk/:id",element:e(Ee,{})}),e(j,{path:"/error",element:e(ye,{})})]})})}function Ae(){return e(G,{children:e(Ce,{})})}de.render(e(he.StrictMode,{children:e(Ae,{})}),document.getElementById("root"));
